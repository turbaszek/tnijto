<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TnijTo - link shortener</title>
    <!-- CSS -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">

    <link href="https://fonts.googleapis.com/css2?family=Nosifer&family=Titillium+Web:wght@300;400&display=swap" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/fdd938fea1.js" crossorigin="anonymous"></script>

</head>

<script>
    function post(url, data, success) {
        let params = typeof data == 'string' ? data : Object.keys(data).map(
            function(k){ return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]) }
        ).join('&');

        let xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        xhr.open('POST', url);
        xhr.onreadystatechange = function() {
            if (xhr.readyState>3 && xhr.status==200) { success(xhr.responseText); }
        };
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send(params);
        return xhr;
    }

    function submitForm() {
        let linkElement = document.getElementById("link")
        let nameElement = document.getElementById("name")
        let linkURL = linkElement.value
        let value = nameElement.value

        if (linkURL !== "") {
            post("/api/new", {'originalURL': linkURL, 'value': value}, showLink)
            linkElement.value = ""
            nameElement.value = ""
        }
    }

    function showLink(dataText) {
        let data = JSON.parse(dataText)
        let url = data.GeneratedURL

        let msg = document.getElementById("generated-url");
        let generatedURL = document.getElementById("generated-url-value");

        if (msg.style.display === "none") {
            msg.style.display = "block";
            generatedURL.textContent = url;
        } else {
            generatedURL.textContent = url;
        }

    }

    window.addEventListener("keydown", function(event) {
        if (event.key === "Enter") {
            event.preventDefault();
            submitForm();
        }
    });

</script>
<body>
    <header>
        <div id="logo">
            <h1>T</h1>
            <div class="triangle-up"></div>
        </div>
        <div id="switch-holder">
            <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="customSwitch1">
                <label class="custom-control-label" for="customSwitch1">Toggle this switch element</label>
            </div>
        </div>
    </header>
    <main>
        <div class="banner">
            <h1>TNIJ TO!</h1>
            <h3>Twój skracacz linków online!</h3>
            <p>
                Tnij to, jeśli jest za długie i brzydkie! <br />
                Opcjonalnie: sam zaproponuje ładną nazwę uciętego adresu!
            </p>
        </div>
        <hr>
        <div class="form-holder">
            <form action="">
                <input type="text" placeholder="Długi i brzydki URI" autofocus />
                <div>
                    <a href="#tailored-cut" class="" data-toggle="collapse">
                        Tnij na wymiar!<i class="fas fa-plus-circle"></i></a>
                    <div id="tailored-cut" class="collapse">
                        <input type="text" placeholder="Link na wymiar">
                    </div>
                </div>
<!--                <input type="text" placeholder="Enter your new link value or leave empty for random link value" >*/ -->
                <button>Tnij!</button>
            </form>
        </div>
    </main>
    <footer>
        <a href="https://github.com/turbaszek/tnijto">
            <i class="fab fa-github"></i>
        </a>
    </footer>
</body>
</html>

<!--<div class="flex-centered">*/
<!--    <div class="container center">*/
<!--        <div class="columns">*/
<!--            <div class="column col-1 col-mx-auto">*/
<!--                <h1 class="text-dark massive">Shorten your link!</h1>*/
<!--            </div>*/
<!--        </div>*/
<!--        <div class="columns">*/
<!--            <div class="column col-3 col-mx-auto">*/
<!--                <div class="input-group">*/
<!--                    <input id="link" type="text" class="form-input input-lg" placeholder="Terribly long link...">*/
<!--                    <button id="link-btn" class="btn btn-primary input-group-btn btn-lg" onclick="submitForm()">Submit</button>*/
<!--                </div>*/
<!--                <input class="form-input input-sm" id="name" type="text" value="" placeholder="Fancy short name..."/>*/

<!--                <p id="generated-url" style="display: none">Your link <cite id="generated-url-value"></cite></p>*/

<!--            </div>*/
<!--        </div>*/
<!--    </div>*/
<!--</div>*/
